........................................................................ [ 41%]
.....................................................................FFF [ 82%]
..FF...F..F.FFFFFFFFF...FFFFF.                                           [100%]
================================== FAILURES ===================================
__________________ TestPMMRPushRoot.test_root_after_4_leaves __________________
tests\test_pmmr.py:511: in test_root_after_4_leaves
    assert self._pmmr.size() == 7
E   assert 6 == 7
E    +  where 6 = size()
E    +    where size = <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A8324410>.size
E    +      where <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A8324410> = <tests.test_pmmr.TestPMMRPushRoot object at 0x000001A4A83B3190>._pmmr
__________________ TestPMMRPushRoot.test_root_after_8_leaves __________________
tests\test_pmmr.py:519: in test_root_after_8_leaves
    assert self._pmmr.size() == 15
E   assert 11 == 15
E    +  where 11 = size()
E    +    where size = <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A8387250>.size
E    +      where <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A8387250> = <tests.test_pmmr.TestPMMRPushRoot object at 0x000001A4A83B0350>._pmmr
__________________ TestPMMRPushRoot.test_root_after_9_leaves __________________
tests\test_pmmr.py:530: in test_root_after_9_leaves
    assert self._pmmr.size() == 16
E   assert 13 == 16
E    +  where 13 = size()
E    +    where size = <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A82D0750>.size
E    +      where <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A82D0750> = <tests.test_pmmr.TestPMMRPushRoot object at 0x000001A4A83B0610>._pmmr
________________ TestPMMRPushRoot.test_get_hash_internal_node _________________
tests\test_pmmr.py:565: in test_get_hash_internal_node
    assert self._pmmr.get_hash(9) == hashes[9]
E   AssertionError: assert b'\xa5\x82\x9....\x95\xf0\xe6' == b'Ldl\x99}M:\...\x96\xd3#\xf3'
E     
E     At index 0 diff: b'\xa5' != b'L'
E     Use -v to get more diff
_____________________ TestPMMRPushRoot.test_backend_sizes _____________________
tests\test_pmmr.py:581: in test_backend_sizes
    assert self._pmmr.hash_size() == 35
E   assert 32 == 35
E    +  where 32 = hash_size()
E    +    where hash_size = <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A82B3BD0>.hash_size
E    +      where <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A82B3BD0> = <tests.test_pmmr.TestPMMRPushRoot object at 0x000001A4A8394690>._pmmr
______________ TestPMMRPrune.test_prune_sequence_root_unchanged _______________
tests\test_pmmr.py:624: in test_prune_sequence_root_unchanged
    self._pmmr.prune(pos)
mimblewimble\mmr\pmmr.py:380: in prune
    self._compact_ancestors(pos0)
mimblewimble\mmr\pmmr.py:401: in _compact_ancestors
    if not self._subtree_pruned(sibling):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
mimblewimble\mmr\pmmr.py:417: in _subtree_pruned
    left_pos = pos0 - (1 << h)
                       ^^^^^^
E   ValueError: negative shift count
___________________ TestPMMRRewind.test_rewind_to_4_leaves ____________________
tests\test_pmmr.py:655: in test_rewind_to_4_leaves
    assert self._pmmr.size() == 16
E   assert 13 == 16
E    +  where 13 = size()
E    +    where size = <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A819EB10>.size
E    +      where <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A819EB10> = <tests.test_pmmr.TestPMMRRewind object at 0x000001A4A83A2E50>._pmmr
_______________ TestMerkleProof.test_proof_verify_all_leaves[0] _______________
tests\test_pmmr.py:696: in test_proof_verify_all_leaves
    assert proof.mmr_size == 16
E   assert 13 == 16
E    +  where 13 = MerkleProof(mmr_size=13, path=[b'\xd1\xc4rb\x90\x01G-\x919\x8ali\xbb)c\xd5MH=\xe8\xb9\x1c1*\x18T9\x94\x1fN\xa3', b"5?6...xc4\xbca\xcfco\xa3", b'\x90/\xed\xfe]\xc2y\xd4Dc\x86\xb4\x1a\xd3\x9d\xf4\xdc\xb2\xeeS=\xca4\xf7a\x16\xd4L\n3\x8f\xeb']).mmr_size
_______________ TestMerkleProof.test_proof_verify_all_leaves[1] _______________
tests\test_pmmr.py:696: in test_proof_verify_all_leaves
    assert proof.mmr_size == 16
E   assert 13 == 16
E    +  where 13 = MerkleProof(mmr_size=13, path=[b'r\xa5\xe7\x04\xb9I\xf6\xa6\xe6\xc9m\x1c$K\xbd\xf7\xacgb\xc9\xe0%\xe4q9\xd1yM\xf7\x13K...xc4\xbca\xcfco\xa3", b'\x90/\xed\xfe]\xc2y\xd4Dc\x86\xb4\x1a\xd3\x9d\xf4\xdc\xb2\xeeS=\xca4\xf7a\x16\xd4L\n3\x8f\xeb']).mmr_size
_______________ TestMerkleProof.test_proof_verify_all_leaves[3] _______________
tests\test_pmmr.py:696: in test_proof_verify_all_leaves
    assert proof.mmr_size == 16
E   assert 13 == 16
E    +  where 13 = MerkleProof(mmr_size=13, path=[b'g\xe7\xabN:\x10T\xd7\xde}\xc8\xdb\xb6\x08\tc0\xafa\xd7\xf5/1/<"\xea\xdb+F\x8af', b'\x...[\xd0\xd34\x05\x14', b'\x90/\xed\xfe]\xc2y\xd4Dc\x86\xb4\x1a\xd3\x9d\xf4\xdc\xb2\xeeS=\xca4\xf7a\x16\xd4L\n3\x8f\xeb']).mmr_size
_______________ TestMerkleProof.test_proof_verify_all_leaves[4] _______________
tests\test_pmmr.py:696: in test_proof_verify_all_leaves
    assert proof.mmr_size == 16
E   AssertionError: assert 13 == 16
E    +  where 13 = MerkleProof(mmr_size=13, path=[b'\xebS\xc0U\x15]\xdch\x99\xc3e\xd7N\x0fY\x8a9gR\xef,\xd4%\xd5\x8f\xc4a\xbd\xbc\x85\xfd...[\xd0\xd34\x05\x14', b'\x90/\xed\xfe]\xc2y\xd4Dc\x86\xb4\x1a\xd3\x9d\xf4\xdc\xb2\xeeS=\xca4\xf7a\x16\xd4L\n3\x8f\xeb']).mmr_size
_______________ TestMerkleProof.test_proof_verify_all_leaves[7] _______________
tests\test_pmmr.py:696: in test_proof_verify_all_leaves
    assert proof.mmr_size == 16
E   assert 13 == 16
E    +  where 13 = MerkleProof(mmr_size=13, path=[b'\x99\xb5\xf5\xdf\xdd\x97\t}\xe1\xc1\x80\x9d\x02\x0e\xc9\x91\x0b\xee\xc2P\x96T\xe5,\x1...1eK\x12\xfb,I\x1f', b'u\x0e\xaa\xb1\xc3\x93\xb3\t\x8f\x95U\x9e\x92\xd1CPG\xef\xa9\x88\xa3&\xa49\x10\xf9\xbd"\rwv\x0f']).mmr_size
_______________ TestMerkleProof.test_proof_verify_all_leaves[8] _______________
tests\test_pmmr.py:696: in test_proof_verify_all_leaves
    assert proof.mmr_size == 16
E   assert 13 == 16
E    +  where 13 = MerkleProof(mmr_size=13, path=[b"\xdbs\xbf\xa3\xa4\xc5\x8c{\x05#E\x006\xad\x8b5s\x81\x8b\xda\xec\x06t\x9a\xc6\xe6\x03U...1eK\x12\xfb,I\x1f', b'u\x0e\xaa\xb1\xc3\x93\xb3\t\x8f\x95U\x9e\x92\xd1CPG\xef\xa9\x88\xa3&\xa49\x10\xf9\xbd"\rwv\x0f']).mmr_size
______________ TestMerkleProof.test_proof_verify_all_leaves[10] _______________
tests\test_pmmr.py:696: in test_proof_verify_all_leaves
    assert proof.mmr_size == 16
E   AssertionError: assert 13 == 16
E    +  where 13 = MerkleProof(mmr_size=13, path=[b'X2\x89\xc5\xb7\xc3fl\x83\x1bX\x18\xe7x\xa5\x16\xc4s+\xe5\xbbte/\xfa\x88n\x83\x8a\xf1\...l\xe2v\x1eK\x12\xfb,I\x1f', b'\xa5\x82\x99I\x149\xf0{\xf4F;q=\xb6\x82#\xcc\xf8[\x0b\x9b\xcd^1W\x07Q\xb1.\x95\xf0\xe6']).mmr_size
______________ TestMerkleProof.test_proof_verify_all_leaves[11] _______________
tests\test_pmmr.py:696: in test_proof_verify_all_leaves
    assert proof.mmr_size == 16
E   assert 13 == 16
E    +  where 13 = MerkleProof(mmr_size=13, path=[b'N\xddh\x0b\xd3\x80o\xf0\xa0>\xfc\xc0Ew\x14\x94\xa6\x05\x11_46\x89\xee"\\L\xf8\x9c\xc9...l\xe2v\x1eK\x12\xfb,I\x1f', b'\xa5\x82\x99I\x149\xf0{\xf4F;q=\xb6\x82#\xcc\xf8[\x0b\x9b\xcd^1W\x07Q\xb1.\x95\xf0\xe6']).mmr_size
______________ TestMerkleProof.test_proof_verify_all_leaves[15] _______________
tests\test_pmmr.py:696: in test_proof_verify_all_leaves
    assert proof.mmr_size == 16
E   assert 13 == 16
E    +  where 13 = MerkleProof(mmr_size=13, path=[b'{\xcff4\x1a\xf4\xdfd\xc0<\xe8>\xd4[4JWK\x89p-\x00l\xe2v\x1eK\x12\xfb,I\x1f', b'\xa5\x...\xb1.\x95\xf0\xe6', b'u\x0e\xaa\xb1\xc3\x93\xb3\t\x8f\x95U\x9e\x92\xd1CPG\xef\xa9\x88\xa3&\xa49\x10\xf9\xbd"\rwv\x0f']).mmr_size
______________________ TestLeafIters.test_leaf_pos_iter _______________________
tests\test_pmmr.py:747: in test_leaf_pos_iter
    assert positions == [0, 1, 3, 4, 7]
E   assert [0, 1, 3, 4] == [0, 1, 3, 4, 7]
E     
E     Right contains one more item: 7
E     Use -v to get more diff
______________________ TestLeafIters.test_leaf_idx_iter _______________________
tests\test_pmmr.py:751: in test_leaf_idx_iter
    assert pairs == [(0, 0), (1, 1), (2, 3), (3, 4), (4, 7)]
E   assert [(0, 0), (1, ...2, 3), (3, 4)] == [(0, 0), (1, ...3, 4), (4, 7)]
E     
E     Right contains one more item: (4, 7)
E     Use -v to get more diff
________________________ TestLeafIters.test_leaf_count ________________________
tests\test_pmmr.py:754: in test_leaf_count
    assert self._pmmr.leaf_count() == 5
E   assert 4 == 5
E    +  where 4 = leaf_count()
E    +    where leaf_count = <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A7854210>.leaf_count
E    +      where <mimblewimble.mmr.pmmr.PMMR object at 0x000001A4A7854210> = <tests.test_pmmr.TestLeafIters object at 0x000001A4A83862D0>._pmmr
__________________ TestPMMRValidate.test_validate_clean_pmmr __________________
tests\test_pmmr.py:776: in test_validate_clean_pmmr
    self._pmmr.validate()  # no exception
    ^^^^^^^^^^^^^^^^^^^^^
mimblewimble\mmr\pmmr.py:452: in validate
    assert stored == expected, (
           ^^^^^^^^^^^^^^^^^^
E   AssertionError: Hash mismatch at pos0=6: stored=7bcf66341af4df64c03ce83ed45b344a574b89702d006ce2761e4b12fb2c491f, computed=efb6082ad32667c02f5a878ec0032dc15b5dd1c6ff3892f380746f0b1bd8c772
_________________ TestPMMRValidate.test_validate_after_flush __________________
tests\test_pmmr.py:780: in test_validate_after_flush
    self._pmmr.validate()
mimblewimble\mmr\pmmr.py:452: in validate
    assert stored == expected, (
           ^^^^^^^^^^^^^^^^^^
E   AssertionError: Hash mismatch at pos0=6: stored=7bcf66341af4df64c03ce83ed45b344a574b89702d006ce2761e4b12fb2c491f, computed=efb6082ad32667c02f5a878ec0032dc15b5dd1c6ff3892f380746f0b1bd8c772
=========================== short test summary info ===========================
FAILED tests/test_pmmr.py::TestPMMRPushRoot::test_root_after_4_leaves - asser...
FAILED tests/test_pmmr.py::TestPMMRPushRoot::test_root_after_8_leaves - asser...
FAILED tests/test_pmmr.py::TestPMMRPushRoot::test_root_after_9_leaves - asser...
FAILED tests/test_pmmr.py::TestPMMRPushRoot::test_get_hash_internal_node - As...
FAILED tests/test_pmmr.py::TestPMMRPushRoot::test_backend_sizes - assert 32 =...
FAILED tests/test_pmmr.py::TestPMMRPrune::test_prune_sequence_root_unchanged
FAILED tests/test_pmmr.py::TestPMMRRewind::test_rewind_to_4_leaves - assert 1...
FAILED tests/test_pmmr.py::TestMerkleProof::test_proof_verify_all_leaves[0]
FAILED tests/test_pmmr.py::TestMerkleProof::test_proof_verify_all_leaves[1]
FAILED tests/test_pmmr.py::TestMerkleProof::test_proof_verify_all_leaves[3]
FAILED tests/test_pmmr.py::TestMerkleProof::test_proof_verify_all_leaves[4]
FAILED tests/test_pmmr.py::TestMerkleProof::test_proof_verify_all_leaves[7]
FAILED tests/test_pmmr.py::TestMerkleProof::test_proof_verify_all_leaves[8]
FAILED tests/test_pmmr.py::TestMerkleProof::test_proof_verify_all_leaves[10]
FAILED tests/test_pmmr.py::TestMerkleProof::test_proof_verify_all_leaves[11]
FAILED tests/test_pmmr.py::TestMerkleProof::test_proof_verify_all_leaves[15]
FAILED tests/test_pmmr.py::TestLeafIters::test_leaf_pos_iter - assert [0, 1, ...
FAILED tests/test_pmmr.py::TestLeafIters::test_leaf_idx_iter - assert [(0, 0)...
FAILED tests/test_pmmr.py::TestLeafIters::test_leaf_count - assert 4 == 5
FAILED tests/test_pmmr.py::TestPMMRValidate::test_validate_clean_pmmr - Asser...
FAILED tests/test_pmmr.py::TestPMMRValidate::test_validate_after_flush - Asse...
21 failed, 153 passed in 1.98s
